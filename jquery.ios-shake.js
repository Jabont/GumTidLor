(function($){jQuery.shake=function(options){var opts=jQuery.extend({},jQuery.shake.defaults,options);if(opts.debug!==""){var debug=$(opts.debug);debug.append('x: <span id="x">0</span><br>');debug.append('y: <span id="y">0</span><br>');debug.append('z: <span id="z">0</span><br><br>');debug.append('shake: <span id="shake">0</span><br>');debug.append('shakeaccum: <span id="shakeaccum"></span><br>');debug.append('debug: <span id="console"></span><br>');}
var ax=0;var ay=0;var az=0;var axa=0;var aya=0;var aza=0;var shakecount=0;var shakeaccum=0;var curtime=new Date();var prevtime=new Date();var timeout=false;if(window.DeviceMotionEvent===undefined){if(opts.supported!==""){$(opts.supported).html("Your browser does not support Device Orientation and Motion API. Try it on an iPhone, iPod or iPad with iOS 4.2+.");}}else{window.ondevicemotion=function(event){var acc=event.accelerationIncludingGravity;ax=acc.x;ay=acc.y;az=acc.y;axa=ax-((ax*opts.hf)+(axa*(1.0-opts.hf)));aya=ay-((ay*opts.hf)+(aya*(1.0-opts.hf)));aza=az-((az*opts.hf)+(aza*(1.0-opts.hf)));var beenhere=false;var shake=false;if(beenhere){return;}
beenhere=true;if(Math.abs(ax-2*axa)>opts.violence*1.5||Math.abs(ay-2*aya)>opts.violence*2||Math.abs(az-2*aza)>opts.violence*3&&timeout===false){shakeaccum+=1;}
curtime=new Date();var timedelta=curtime.getTime()-prevtime.getTime();$('#console').html(timedelta);if(timeout){if(timedelta>=opts.debounce){timeout=false;}else{timeout=true;}
shakeaccum=0;}
if(shakeaccum>=opts.shakethreshold&&timeout===false){shakecount+=1;$("#shake").html(shakecount);prevtime=curtime;timeout=true;opts.callback.call();}
beenhere=true;};}
if(opts.debug!==""){setInterval(function(){$('#x').html(Math.abs(ax-2*axa).toFixed(1));$('#y').html(Math.abs(ay-2*aya).toFixed(1));$('#z').html(Math.abs(az-2*aza).toFixed(1));$('#shakeaccum').html(shakeaccum);},10);}};})(jQuery);jQuery.shake.defaults={debug:"",supported:"",violence:3.0,hf:0.2,shakethreshold:5,debounce:1000,callback:function(){}};